const Jwk = require("./Jwk");
const MissingKidError = require('../error/validation/MissingKidError');

class Jwks {
    constructor(keys = []) {
        this.keys = Object.create(null);
        for(const k of keys) {
            this.keys[k.kid] = new Jwk(k);
        }
    }

    get(kid) {
        const jwk = this.keys[kid];
        if(!jwk) throw new MissingKidError(kid, `JWKS does not contain a key for kid=${kid}`);

        return jwk;
    }
}

module.exports = Jwks;